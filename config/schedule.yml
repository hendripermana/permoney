import_market_data:
  cron: "0 22 * * 1-5" # 5:00 PM EST / 6:00 PM EDT (NY time) Monday through Friday
  class: "ImportMarketDataJob"
  queue: "scheduled"
  description: "Imports market data daily at 5:00 PM EST (1 hour after market close)"
  args:
    mode: "full"
    clear_cache: false
  
clean_syncs:
  cron: "0 * * * *" # every hour
  class: "SyncCleanerJob"
  queue: "scheduled"
  description: "Cleans up stale syncs (24+ hours old)"

# PRODUCTION-CRITICAL: Fast stuck sync detection and recovery
# Runs every 5 minutes to quickly detect and recover from stuck syncs
# This prevents balance updates from being blocked for long periods
sync_cleanup:
  cron: "*/5 * * * *" # every 5 minutes
  class: "SyncCleanupJob"
  queue: "low_priority"
  description: "Detects and cleans stuck syncs (syncing > 10 min, pending > 15 min)"

run_security_health_checks:
  cron: "0 2 * * 1-5" # 2:00 AM EST / 3:00 AM EDT (NY time) Monday through Friday
  class: "SecurityHealthCheckJob"
  queue: "scheduled"
  description: "Runs security health checks to detect issues with security data"

loan_reminders:
  cron: "0 8 * * *" # every day at 08:00 server time
  class: "LoanRemindersJob"
  queue: "scheduled"
  description: "Sends upcoming/overdue loan payment reminders"

# Rails 8.1: Production-safe monitoring jobs (replaces Thread.new in initializers)
# These jobs work correctly with Puma's worker forking and are more reliable
memory_monitoring:
  cron: "*/5 * * * *" # every 5 minutes
  class: "MemoryMonitoringJob"
  queue: "low_priority"
  description: "Monitors memory usage and detects potential leaks"

database_pool_monitoring:
  cron: "* * * * *" # every minute
  class: "DatabasePoolMonitoringJob"
  queue: "low_priority"
  description: "Monitors database connection pool usage"

sidekiq_queue_monitoring:
  cron: "* * * * *" # every minute
  class: "SidekiqQueueMonitoringJob"
  queue: "low_priority"
  description: "Monitors Sidekiq queue depths and job status"

cache_monitoring:
  cron: "*/5 * * * *" # every 5 minutes
  class: "CacheMonitoringJob"
  queue: "low_priority"
  description: "Monitors cache statistics and performance"

redis_memory_monitoring:
  cron: "*/5 * * * *" # every 5 minutes
  class: "RedisMemoryMonitoringJob"
  queue: "low_priority"
  description: "Alerts if Redis memory usage approaches maxmemory to prevent job loss"

# Balance audit: sample accounts, recalc recent window, auto-heal if mismatch
balance_audit:
  cron: "15 3 * * *" # daily at 03:15 server time
  class: "BalanceAuditJob"
  queue: "low_priority"
  description: "Samples accounts and queues windowed resync (last 7 days) to auto-heal backdated edits"

# Sync all accounts for all families periodically
# Ensures linked accounts stay fresh even if users don't visit
sync_all_accounts:
  cron: "0 */6 * * *" # every 6 hours
  class: "SyncAllAccountsJob"
  queue: "scheduled"
  description: "Triggers sync for all linked accounts across all families"

