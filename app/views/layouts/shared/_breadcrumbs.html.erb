<%# locals: (breadcrumbs:) %>
<%#
  Breadcrumb navigation using BreadcrumbComponent

  Backward compatible with old array format: [["Name", "/path"], ...]
  New format supports icons: [{ text: "Name", href: "/path", icon: "home" }, ...]
%>

<% if breadcrumbs.present? %>
  <%# Convert old array format to new hash format if needed %>
  <% normalized_items = breadcrumbs.map.with_index do |item, index|
    is_last = (index == breadcrumbs.size - 1)

    # Handle new hash format
    if item.is_a?(Hash)
      item.merge(current: is_last)
    # Handle old array format [name, path]
    elsif item.is_a?(Array)
      {
        text: item[0],
        href: item[1],
        current: is_last
      }
    else
      # Handle plain string (shouldn't happen but be defensive)
      {
        text: item.to_s,
        current: is_last
      }
    end
  end %>

  <%= render BreadcrumbComponent.new(items: normalized_items) %>
<% end %>
