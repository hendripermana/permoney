<%# locals: (account:, url:, form_prefix: nil, form_data: nil) %>

<% form_prefix = local_assigns[:form_prefix] %>
<% custom_form_data = local_assigns[:form_data] %>

<% if @error_message.present? %>
  <%= render DS::Alert.new(message: @error_message, variant: :error) %>
<% end %>

<% merged_form_data = { turbo: false }.merge(custom_form_data || {}) %>

<%= styled_form_with model: account, url: url, scope: :account, data: merged_form_data, class: "flex flex-col gap-4 justify-between grow text-primary" do |form| %>
  <div class="grow space-y-2">
    <%= form.hidden_field :accountable_type %>
    <%= form.hidden_field :return_to, value: params[:return_to] %>

    <%= form_prefix.call(form) if form_prefix.respond_to?(:call) %>

    <%= form.text_field :name, placeholder: t(".name_placeholder"), required: "required", label: t(".name_label") %>

    <% unless account.linked? %>
      <%= form.money_field :balance, label: t(".balance"), required: true, default_currency: Current.family.currency %>
    <% end %>

    <%= yield form %>
  </div>

  <%= form.submit %>
<% end %>
