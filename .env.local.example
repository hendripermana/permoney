# To enable / disable self-hosting features.
SELF_HOSTED=true

# Enable Twelve market data (careful, this will use your API credits)
TWELVE_DATA_API_KEY=

# Langfuse config
LANGFUSE_PUBLIC_KEY=
LANGFUSE_SECRET_KEY=
LANGFUSE_HOST=https://cloud.langfuse.com

# Set to `true` to get error messages rendered in the /chats UI
AI_DEBUG_MODE=

# ============================================================================
# PERFORMANCE OPTIMIZATION SETTINGS
# ============================================================================

# Ruby YJIT Configuration (12-40% performance boost)
# Enable YJIT for production performance gains
RUBY_YJIT_ENABLE=1
# Optional: Limit YJIT memory usage (default: 128MB, can reduce to 64MB if needed)
# RUBY_YJIT_EXEC_MEM_SIZE=64

# Ruby GC Tuning for better memory management
RUBY_GC_HEAP_GROWTH_FACTOR=1.1
RUBY_GC_HEAP_GROWTH_MAX_SLOTS=10000
RUBY_GC_HEAP_INIT_SLOTS=600000
RUBY_GC_HEAP_FREE_SLOTS=100000
RUBY_GC_HEAP_OLDOBJECT_LIMIT_FACTOR=2.0

# Puma Configuration
# Workers: Set to number of CPU cores (M1 MacBook: 8-10 cores)
# Development: 2-4 workers, Production: 1 per CPU core
WEB_CONCURRENCY=4
# Threads: 3-5 per worker for optimal balance
# Total capacity = workers × threads (e.g., 4 × 5 = 20 concurrent requests)
RAILS_MAX_THREADS=5
# Puma worker timeout (seconds)
PUMA_WORKER_TIMEOUT=60
# Puma worker boot timeout (seconds)
PUMA_WORKER_BOOT_TIMEOUT=60

# Database Configuration
# Connection pool should be: (workers × threads) + sidekiq_concurrency + buffer
# Example: (4 × 5) + 10 + 5 = 35 connections
DB_POOL=35
# Database timeouts (seconds)
DB_STATEMENT_TIMEOUT=15
DB_CONNECT_TIMEOUT=5
DB_LOCK_TIMEOUT=10
# Connection reaping frequency (seconds)
DB_REAPING_FREQUENCY=10

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
# Redis for caching (separate database)
REDIS_CACHE_URL=redis://localhost:6379/1
# Redis connection pool size
REDIS_POOL_SIZE=10
# Redis timeouts (seconds)
REDIS_CONNECT_TIMEOUT=5
REDIS_READ_TIMEOUT=1
REDIS_WRITE_TIMEOUT=1

# Sidekiq Configuration
# Concurrency: 10-25 threads for optimal background job processing
SIDEKIQ_CONCURRENCY=10

# Sentry Performance Monitoring
# Increase sampling for better observability
SENTRY_TRACES_SAMPLE_RATE=0.5
SENTRY_PROFILES_SAMPLE_RATE=0.1
# Enable OpenTelemetry integration
SENTRY_USE_OTEL=false

# Cache Configuration
# Cache namespace for multi-tenant isolation
CACHE_NAMESPACE=permoney_dev
# Cache compression threshold (bytes)
CACHE_COMPRESS_THRESHOLD=1024
